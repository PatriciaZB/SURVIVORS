<div class="container">

  <div class="d-flex flex-row justify-content-between align-items-baseline">
    <div class=" col-sm-12 col-md-4 mb-3">
      <div class="activity-title">
        <div> <h2 class="title" data-content="Activities">Activities</h2></div>
      </div>
    </div>
    <div class="searchbar col-sm-12 col-md-8">
    <%= form_tag activities_path, class: "form-horizontal pr-0", method: :get do %>
      <%= text_field_tag :query,
        params[:query],
        class: "form-control",
        placeholder: "Find an Activity" %>
      <%= date_field_tag :starts_at, params[:starts_at], class: "form-data datepicker", placeholder: "  Pick a date" %>
      <%= submit_tag "Search", class: "btn btn-success ml-3" %>
    <% end %>
    </div>
  </div>
  <div class="row">
    <div class="cards-list col-sm-12 col-md-7" style=" margin-top: 5px;">
      <% @activities.each do |activity| %>
        <div class="card-ws py-3">
            <div class="card-image">
              <% if activity.image.attached? %>
                <%= cl_image_tag activity.image.key, height: 200, width: 200, crop: :fill %>
                <% else %>
                <%= image_tag activity.Altimage, height: 200, width: 200, crop: :fill %>
              <% end %>
            </div>
            <div class="card-body">
              <div class="card-body-text" style="text-align: justify">
                <div class="d-flex justify-content-between w-100">
                  <h3> <%= link_to activity.name.capitalize, activity_path(activity) %> </h3>
                  <% if !activity.reviews.empty? %>
                  <p style="text-align:left">
                    <strong> <i class="fas fa-heart"></i> <span> <%= activity.reviews.average(:rating).round(1) %> / 5 </span> </strong>
                  </p>
                  <% end %>
                </div>

                <p> <%= activity.description.first(100) %>... </p>
              </div>

              <p style="font-size:14px"> <strong>  <%= activity.category %></strong></p>
              <div class="card-location">
                  <%= image_tag("icon-map.png",class: "image-location", :alt => "map") %>
                <p><%= activity.address %></p>
                <p class="pl-2"><strong><%= activity.start_at.strftime("%b %e, %l:%M")%> - <%= activity.end_at.strftime("%l:%M %p") %> </strong></p>
              </div>
            </div>
        </div>
      <% end %>
    </div>
    <div class="col-sm-12 col-md-5" style="margin-top: 5px;">

      <div id="map"
       style="width: 100%; height: 600px ;border: 4px solid; border-color: #CE796B ;border-radius: 17px"
       data-markers="<%= @markers.to_json %>"
       data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>
  </div>
</div>

